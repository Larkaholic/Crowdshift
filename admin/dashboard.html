<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Crowdshift • Admin Dashboard</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
		<script src="https://cdn.tailwindcss.com"></script>
		<script>
			tailwind.config = {
				theme: {
					extend: {
						fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui"] },
						colors: {
							brand: {
								50: "#ECFDF5",
								100: "#D1FAE5",
								200: "#A7F3D0",
								300: "#6EE7B7",
								400: "#34D399",
								500: "#10B981",
								600: "#059669",
								700: "#047857",
								800: "#065F46",
								900: "#064E3B",
							},
						},
						boxShadow: {
							card: "0 1px 2px rgba(16,24,40,.06), 0 1px 3px rgba(16,24,40,.1)",
						},
					},
				},
			};
		</script>
		<style>
			html, body { height: 100%; width: 100%; overflow-x: hidden;}
			body { background: #f7faf9; }
			*, *::before, *::after { box-sizing: border-box; }
			#active-chart { display: block; max-width: 100% !important; }
		</style>
	</head>
		<body class="min-h-full text-slate-800 w-full md:w-full mx-auto overflow-x-hidden px-3 md:px-0 flex flex-col">
			<!-- Header -->
			<header class="sticky top-0 z-10 mb-4 rounded-2xl bg-white/80 p-2 md:p-3 backdrop-blur supports-[backdrop-filter]:bg-white/60 shadow-card">
				<div class="flex items-center gap-3">
					<div class="flex h-9 w-9 items-center justify-center rounded-lg bg-brand-100 text-brand-700">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6"><path d="M12 2a10 10 0 100 20 10 10 0 000-20Zm1 5a1 1 0 10-2 0v5a1 1 0 00.293.707l3 3a1 1 0 101.414-1.414L13 11.586V7Z"/></svg>
					</div>
					<div class="flex-1">
						<div class="text-xs text-slate-500">Crowdshift</div>
						<div class="text-base font-semibold">Admin Dashboard</div>
					</div>
					<a href="/index.html" class="inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-3 py-2 text-xs font-medium text-slate-700 shadow-card hover:bg-slate-50">Back to App</a>
				</div>
			</header>

			<main class="w-full max-w-full lg:max-w-7xl flex flex-col justify-center lg:grid lg:grid-cols-12 lg:gap-4 mx-auto">
				<!-- KPIs -->
				<section class="rounded-2xl bg-white p-2 md:p-3 shadow-card lg:col-span-12 w-full md:w-full mb-4">
					<div class="mb-3 flex items-center justify-between">
						<div>
							<div class="text-xs font-semibold">City Analytics</div>
							<div class="text-[10px] text-slate-500">Live overview • From dataset</div>
						</div>
						<div class="flex items-center gap-2">
							<button id="admin-refresh" class="rounded-lg border border-slate-200 px-2.5 py-1.5 text-[10px] text-slate-700 hover:bg-slate-50">Refresh</button>
							<button id="admin-randomize" class="rounded-lg border border-slate-200 px-2.5 py-1.5 text-[10px] text-slate-700 hover:bg-slate-50">Randomize Active</button>
						</div>
					</div>
					<div class="grid grid-cols-2 gap-3 md:grid-cols-4">
						<div class="rounded-xl border border-slate-100 bg-slate-50 p-3">
							<div class="text-[10px] text-slate-500">Active Tourists</div>
							<div id="kpi-active" class="mt-1 text-2xl font-extrabold">—</div>
						</div>
						<div class="rounded-xl border border-slate-100 bg-slate-50 p-3">
							<div class="text-[10px] text-slate-500">Hotspots Active</div>
							<div id="kpi-hotspots" class="mt-1 text-2xl font-extrabold">—/—</div>
						</div>
						<div class="rounded-xl border border-slate-100 bg-slate-50 p-3">
							<div class="text-[10px] text-slate-500">Avg Occupancy</div>
							<div id="kpi-occupancy" class="mt-1 text-2xl font-extrabold">—%</div>
						</div>
						<div class="rounded-xl border border-slate-100 bg-slate-50 p-3">
							<div class="text-[10px] text-slate-500">Spots Monitored</div>
							<div id="kpi-spots" class="mt-1 text-2xl font-extrabold">—</div>
						</div>
					</div>
				</section>

				<!-- Trend Chart + Actions -->
				<section class="rounded-2xl bg-white p-2 md:p-3 shadow-card lg:col-span-8 w-full mb-4 md:w-full">
					<div class="mb-2 flex items-center justify-between">
						<div>
							<div class="text-xs font-semibold">Active Visitors Trend</div>
							<div class="text-[10px] text-slate-500">Past 12 intervals and projection (dashed)</div>
						</div>
					</div>
					<div class="flex items-center gap-2 text-[10px] text-slate-600 overflow-x-auto pb-2">
						<div class="flex items-center gap-2 min-w-max">
							<button id="toggle-forecast-btn" class="rounded-lg border border-slate-200 px-2.5 py-1 text-[10px] hover:bg-slate-50" title="Toggle projection">Show projection</button>
							<input id="toggle-forecast" type="checkbox" class="hidden" aria-hidden="true" />
							<select id="forecast-horizon" class="rounded border border-slate-200 bg-white px-1.5 py-0.5" title="How far ahead to project">
								<option value="3">+3</option>
								<option value="6" selected>+6</option>
								<option value="12">+12</option>
							</select>
							<select id="forecast-method" class="rounded border border-slate-200 bg-white px-1.5 py-0.5" title="Forecasting method">
								<option value="linear" selected>Linear trend</option>
								<option value="ses">Exponential smoothing</option>
								<option value="ma">Moving average</option>
								<option value="holt">Holt trend</option>
							</select>
							<div id="param-ses" class="inline-flex items-center gap-1"></div>
								<label for="smoothing-alpha" class="text-slate-500">alpha</label>
								<input id="smoothing-alpha" type="number" min="0.05" max="0.95" step="0.05" value="0.3" class="w-16 rounded border border-slate-200 bg-white px-1.5 py-0.5" title="Smoothing (alpha)" />
							</div>
							<div id="param-ma" class="inline-flex items-center gap-1 hidden">
								<label for="ma-window" class="text-slate-500">window</label>
								<input id="ma-window" type="number" min="2" max="10" step="1" value="3" class="w-16 rounded border border-slate-200 bg-white px-1.5 py-0.5" title="MA window" />
							</div>
							<label class="inline-flex items-center gap-1 cursor-pointer" title="Show uncertainty band">
								<input id="toggle-band" type="checkbox" class="accent-brand-600" />
								<span>Uncertainty</span>
							</label>
						</div>
					</div>
					<canvas id="active-chart" class="h-[200px] md:h-[260px] w-full"></canvas>
					<div class="mt-2 text-[10px] text-slate-600" id="forecast-summary">Turn on Projection to see the next 6 intervals.</div>
					<button id="forecast-info-toggle" class="mt-1 text-[10px] text-brand-700 hover:underline">What does this mean?</button>
					<div id="forecast-info" class="mt-1 text-[10px] text-slate-500 hidden">The solid line shows recent visitor counts. The dashed line is a projection using your selected method (Linear, Smoothing, Moving Average, or Holt). If the uncertainty band is on, the shaded area shows a typical range based on past errors. These are estimates and will update as new data comes in.</div>
				</section>

				<!-- Import/Export -->
				<section class="rounded-2xl bg-white p-2 md:p-3 shadow-card lg:col-span-4 w-full mb-4  md:w-full">
					<div class="mb-2 text-xs font-semibold">Data Management</div>
					<div class="space-y-2 text-[12px]">
						<div class="rounded-xl border border-slate-100 p-2">
							<div class="mb-2 text-[11px] font-semibold">Dataset</div>
							<div class="flex items-center gap-2">
								<input id="file-import" type="file" accept="application/json" class="block w-full text-[10px]" />
								<button id="btn-import" class="rounded-lg border border-slate-200 px-2.5 py-1.5 text-[10px] hover:bg-slate-50">Import</button>
							</div>
							<div class="mt-2 text-[10px] text-slate-500">Or export current dataset:</div>
							<button id="btn-export" class="mt-2 w-full rounded-lg bg-brand-600 px-3 py-1.5 text-[10px] font-semibold text-white hover:bg-brand-700">Export JSON</button>
						</div>
					</div>
				</section>

				<!-- Spots Table -->
				<section class="rounded-2xl bg-white p-2 md:p-3 shadow-card lg:col-span-12 w-full mb4 md:w-full">
					<div class="mb-2 flex items-center justify-between">
						<div>
							<div class="text-xs font-semibold">Tourist Spots</div>
							<div class="text-[10px] text-slate-500">Capacity and active visitors</div>
						</div>
						<div class="flex items-center gap-2">
							<button id="add-row" class="rounded-lg border border-slate-200 px-2.5 py-1.5 text-[10px] hover:bg-slate-50">Add Spot</button>
							<button id="save-table" class="rounded-lg bg-brand-600 px-3 py-1.5 text-[10px] font-semibold text-white hover:bg-brand-700">Save Changes</button>
						</div>
					</div>
								<div class="overflow-x-auto">
									<table class="min-w-full table-fixed text-left text-[12px]">
							<thead>
								<tr class="text-slate-500">
												<th class="px-2 py-2 w-[30%]">Name</th>
												<th class="px-2 py-2 w-[12%]">Capacity</th>
												<th class="px-2 py-2 w-[12%]">Active</th>
												<th class="px-2 py-2 w-[14%]">Occupancy</th>
												<th class="px-2 py-2 w-[14%]">Hotspot</th>
												<th class="px-2 py-2 w-[18%]"></th>
								</tr>
							</thead>
							<tbody id="spots-body"></tbody>
						</table>
					</div>
				</section>
			</main>

		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
		<script src="/admin/adminjs/admin.js" defer></script>
	</body>
	</html>
